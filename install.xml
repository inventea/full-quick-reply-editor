<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<?xml-stylesheet type="text/xsl" href="modx.prosilver.en.xsl" ?>
<!-- For security purposes, please check: http://www.phpbb.com/mods/ for the latest version of this MOD.\nAlthough MODs are checked before being allowed in the MODs Database there is no guarantee that there are no security problems within the MOD.\nNo support will be given for MODs not found within the MODs Database which can be found at http://www.phpbb.com/mods/ -->
<mod xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.phpbb.com/mods/xml/modx-1.2.3.xsd">
	<header>
		<license><![CDATA[GNU General Public License v3]]></license>
		
		<title lang="en"><![CDATA[Full Quick Reply Editor]]></title>
		<title lang="pl"><![CDATA[Full Quick Reply Editor]]></title>
		
		<description lang="en"><![CDATA[Transforms the basic quick reply editor into the full version with post icons, emoticons and BBCode buttons.]]></description>
		<description lang="pl"><![CDATA[Rozszerza funkcje podstawowego edytora szybkiej odpowiedzi o ikony posta, emotikony oraz znaczniki BBCode.]]></description>
		
		<author-notes lang="en"><![CDATA[Works only with phpBB 3.0.6 and above!]]></author-notes>
		<author-notes lang="pl"><![CDATA[Działa wyłącznie na phpBB 3.0.6 i nowszym!]]></author-notes>
		
		<author-group>
			<author>
				<realname><![CDATA[Jarosław Pustuła]]></realname>
				<username phpbbcom="no"><![CDATA[medeish]]></username>
				<homepage><![CDATA[http://inventia.io]]></homepage>
				<email><![CDATA[office@inventia.io]]></email>
			</author>
		</author-group>
		
		<mod-version>1.0.1</mod-version>
		
		<installation>
			<level>easy</level>
			<time>300</time>
			<target-version>3.0.6</target-version>
		</installation>
		
		<history>
			<entry>
				<date>2009-11-26</date>
				<rev-version>1.0.0</rev-version>
				<changelog lang="en">
					<change><![CDATA[Initial release]]></change>
				</changelog>
				<changelog lang="pl">
					<change><![CDATA[Pierwsze wydanie]]></change>
				</changelog>
			</entry>
			<entry>
				<date>2009-12-24</date>
				<rev-version>1.0.1</rev-version>
				<changelog lang="en">
					<change><![CDATA[Fixed undefined variable notice]]></change>
				</changelog>
				<changelog lang="pl">
					<change><![CDATA[Poprawiono komunikat o niezdefiniowanej zmiennej]]></change>
				</changelog>
			</entry>
		</history>
		
		<link-group>
			<link type="template" href="templates/prosilver.xml" lang="en">prosilver</link>
			<link type="template" href="templates/subsilver2.xml" lang="en">subsilver2</link>
		</link-group>
	</header>
	
	<action-group>
		<open src="viewtopic.php">
			<edit>
				<find><![CDATA[include($phpbb_root_path . 'includes/functions_display.' . $phpEx);]]></find>
				<action type="after-add"><![CDATA[include($phpbb_root_path . 'includes/functions_posting.' . $phpEx);]]></action>
			</edit>
			<edit>
				<find><![CDATA[if ($s_can_vote || $s_quick_reply)
{
	add_form_key('posting');

	if ($s_quick_reply)
	{]]></find>
				<action type="after-add"><![CDATA[		$user->setup(array('posting', 'mcp'));]]></action>
			</edit>
			<edit>
				<find><![CDATA[		$s_attach_sig	= $config['allow_sig'] && $user->optionget('attachsig') && $auth->acl_get('f_sigs', $forum_id) && $auth->acl_get('u_sig');
		$s_smilies		= $config['allow_smilies'] && $user->optionget('smilies') && $auth->acl_get('f_smilies', $forum_id);
		$s_bbcode		= $config['allow_bbcode'] && $user->optionget('bbcode') && $auth->acl_get('f_bbcode', $forum_id);
		$s_notify		= $config['allow_topic_notify'] && $user->data['user_notify'];]]></find>
				<action type="after-add"><![CDATA[		$s_url			= $config['allow_post_links']; 
		$s_img			= $s_bbcode && $auth->acl_get('f_img', $forum_id);
		$s_flash		= $s_bbcode && $auth->acl_get('f_flash', $forum_id) && $config['allow_post_flash'];
		$s_topic_icons	= false;
		
		if ($topic_data['enable_icons'] && $auth->acl_get('f_icons', $forum_id))
		{
			$s_topic_icons = posting_gen_topic_icons('reply', $topic_data['icon_id']); 
		}]]></action>
			</edit>
			<edit>
				<find><![CDATA[		$template->assign_vars(array(
			'S_QUICK_REPLY'			=> true,
			'U_QR_ACTION'			=> append_sid("{$phpbb_root_path}posting.$phpEx", "mode=reply&amp;f=$forum_id&amp;t=$topic_id"),
			'QR_HIDDEN_FIELDS'		=> build_hidden_fields($qr_hidden_fields),
			'SUBJECT'				=> 'Re: ' . censor_text($topic_data['topic_title']),
		));]]></find>
				<action type="replace-with"><![CDATA[		$template->assign_vars(array(
			'L_ICON'					=> $user->lang['POST_ICON'],
			'L_MESSAGE_BODY_EXPLAIN'	=> (intval($config['max_post_chars'])) ? sprintf($user->lang['MESSAGE_BODY_EXPLAIN'], intval($config['max_post_chars'])) : '',
	
			'SUBJECT'				=> 'Re: ' . censor_text($topic_data['topic_title']),
			'BBCODE_STATUS'			=> ($s_bbcode) ? sprintf($user->lang['BBCODE_IS_ON'], '<a href="' . append_sid("{$phpbb_root_path}faq.$phpEx", 'mode=bbcode') . '">', '</a>') : sprintf($user->lang['BBCODE_IS_OFF'], '<a href="' . append_sid("{$phpbb_root_path}faq.$phpEx", 'mode=bbcode') . '">', '</a>'),
			'IMG_STATUS'			=> ($s_img) ? $user->lang['IMAGES_ARE_ON'] : $user->lang['IMAGES_ARE_OFF'],
			'FLASH_STATUS'			=> ($s_flash) ? $user->lang['FLASH_IS_ON'] : $user->lang['FLASH_IS_OFF'],
			'SMILIES_STATUS'		=> ($s_smilies) ? $user->lang['SMILIES_ARE_ON'] : $user->lang['SMILIES_ARE_OFF'],
			'URL_STATUS'			=> ($s_bbcode && $s_url) ? $user->lang['URL_IS_ON'] : $user->lang['URL_IS_OFF'],
			'U_QR_ACTION'			=> append_sid("{$phpbb_root_path}posting.$phpEx", "mode=reply&amp;f=$forum_id&amp;t=$topic_id"),
			'QR_HIDDEN_FIELDS'		=> build_hidden_fields($qr_hidden_fields),
			
			'S_QUICK_REPLY'			=> true,
			'S_SHOW_TOPIC_ICONS'	=> $s_topic_icons,
			'S_BBCODE_ALLOWED'		=> $s_bbcode,
			'S_SMILIES_ALLOWED'		=> $s_smilies,
			'S_LINKS_ALLOWED'		=> $s_url,
			
			'S_BBCODE_IMG'			=> $s_img,
			'S_BBCODE_URL'			=> $s_url,
			'S_BBCODE_FLASH'		=> $s_flash,
			'S_BBCODE_QUOTE'		=> true,
		));
		
		// Build custom bbcodes array
		display_custom_bbcodes();
		
		// Generate smiley listing
		generate_smilies('inline', $forum_id);]]></action>
			</edit>
		</open>
	</action-group>
</mod>